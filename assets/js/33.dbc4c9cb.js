(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{416:function(t,e,s){"use strict";s.r(e);var r=s(48),a=Object(r.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#router"}},[t._v("#")]),t._v(" Router")]),t._v(" "),s("p",[t._v("The "),s("RouterLink",{attrs:{to:"/reference/Chevere/Components/Router/Router.html"}},[t._v("Router")]),t._v(" component is in charge of collecting "),s("RouterLink",{attrs:{to:"/reference/Chevere/Components/Router/Routables.html"}},[t._v("Routables")]),t._v(".")],1),t._v(" "),s("p",[t._v("The router component is built on top of "),s("a",{attrs:{href:"https://github.com/nikic/FastRoute",target:"_blank",rel:"noopener noreferrer"}},[t._v("FastRoute"),s("OutboundLink")],1),t._v(", but with added context for the Chevere realm which also means more strictness.")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Learn by Example")]),t._v(" "),s("p",[t._v("Check the Router "),s("a",{attrs:{href:"https://github.com/chevere/examples/tree/main/03.Http#00router-makephp",target:"_blank",rel:"noopener noreferrer"}},[t._v("examples"),s("OutboundLink")],1),t._v(" to learn directly playing with code.")])]),t._v(" "),s("h2",{attrs:{id:"routing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#routing"}},[t._v("#")]),t._v(" Routing")]),t._v(" "),s("p",[t._v("Routing works by defining routes and HTTP method to "),s("RouterLink",{attrs:{to:"/components/Action.html#controller"}},[t._v("Controller")]),t._v(" matching using file system based conventions. Routes are defined in a folder-based structure.")],1),t._v(" "),s("p",[t._v("Tree below shows how a routing directory looks like.")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("/var/routing\n├── articles "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("- route /articles/\n│   ├── "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("- route /articles/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/\n│   │   └── GET.php\n│   └── GET.php\n└── post "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("- route /post/\n    └── POST.php\n")])])]),s("p",[t._v("File-system folder paths will reflect HTTP route paths.")]),t._v(" "),s("p",[t._v("Table below shows how system paths are interpreted as HTTP route paths for the "),s("a",{attrs:{href:"#routing-filesystem-structure"}},[t._v("tree")]),t._v(" above.")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Path")]),t._v(" "),s("th",[t._v("HTTP route")]),t._v(" "),s("th",[t._v("HTTP method")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("/var/routing/articles/")]),t._v(" "),s("td",[t._v("/articles/")]),t._v(" "),s("td",[t._v("GET")])]),t._v(" "),s("tr",[s("td",[t._v("/var/routing/articles/{id}/")]),t._v(" "),s("td",[t._v("/articles/123/")]),t._v(" "),s("td",[t._v("GET")])]),t._v(" "),s("tr",[s("td",[t._v("/var/routing/post/")]),t._v(" "),s("td",[t._v("/post/")]),t._v(" "),s("td",[t._v("POST")])])])]),t._v(" "),s("p",[t._v("Each folder may define many "),s("a",{attrs:{href:"#methodnamephp"}},[s("methodName",[t._v(".php")])],1),t._v(" for each applicable HTTP method. Variables in the form of "),s("code",[t._v("{var}")]),t._v(" are used to define dynamic route parameters known as "),s("a",{attrs:{href:"#wildcards"}},[t._v("wildcards")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"methodname-php"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#methodname-php"}},[t._v("#")]),t._v(" "),s("code",[t._v("<methodName>.php")])]),t._v(" "),s("p",[t._v("HTTP endpoints are defined by using "),s("code",[t._v("<methodName>.php")]),t._v(" naming convention, where "),s("code",[t._v("<methodName>")]),t._v(" is the HTTP method name according to "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc7231",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 7231"),s("OutboundLink")],1),t._v(" and it must return a "),s("RouterLink",{attrs:{to:"/components/Action.html#controller"}},[t._v("Controller")]),t._v(".")],1),t._v(" "),s("p",[t._v("Accepted HTTP methods are "),s("code",[t._v("CONNECT, DELETE, GET, HEAD, OPTIONS, PATCH, POST, PUT, TRACE")]),t._v(".")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("/var/routing/post/POST.php")]),t._v(" file below binds HTTP request "),s("code",[t._v("POST /post/")]),t._v(" to "),s("code",[t._v("PostController")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /var/routing/post/POST.php")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Controllers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PostController")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PostController")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("It is recommended to create a "),s("em",[t._v("different")]),t._v(" "),s("RouterLink",{attrs:{to:"/components/Action.html#controller"}},[t._v("Controller")]),t._v(" for each HTTP endpoint. A controller resolving multiple HTTP endpoints is a bad practice.")],1)]),t._v(" "),s("p",[t._v("Note: Method "),s("code",[t._v("HEAD")]),t._v(" is automatically added when adding "),s("code",[t._v("GET")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"wildcards"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wildcards"}},[t._v("#")]),t._v(" Wildcards")]),t._v(" "),s("p",[t._v("Wildcards are expressed as "),s("code",[t._v("{var}")]),t._v("  for folder-names as "),s("code",[t._v("{id}")]),t._v(" in "),s("code",[t._v("/articles/{id}/")]),t._v(".")]),t._v(" "),s("p",[t._v("Wildcards are used to define route parameters which will be automatically configured to reflect the "),s("RouterLink",{attrs:{to:"/components/Action.html#controller"}},[t._v("Controller")]),t._v(" parameters defined for the given route.")],1),t._v(" "),s("p",[t._v("Note that controllers in the alleged route must define the same base wildcard parameters.")]),t._v(" "),s("h2",{attrs:{id:"generating-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generating-router"}},[t._v("#")]),t._v(" Generating Router")]),t._v(" "),s("p",[t._v("The Router can be easily generated using the built-in tooling.")]),t._v(" "),s("h3",{attrs:{id:"descriptors-maker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#descriptors-maker"}},[t._v("#")]),t._v(" Descriptors Maker")]),t._v(" "),s("p",[t._v("The "),s("RouterLink",{attrs:{to:"/reference/Chevere/Components/Router/Routing/RoutingDescriptorsMaker.html"}},[t._v("RoutingDescriptorsMaker")]),t._v(" component is in charge of creating the routing descriptors, which is the collection of routes interpreted from the filesystem.")],1),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("Chevere"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Components"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Routing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("RoutingDescriptorsMaker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("Chevere"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Components"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Filesystem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("dirForPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$routingDescriptorsMaker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RoutingDescriptorsMaker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token argument-name"}},[t._v("repository")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'app-routes'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$routingDescriptors")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$routingDescriptorsMaker")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("withDescriptorsFor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token argument-name"}},[t._v("dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dirForPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'/var/routing/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("descriptors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"router-for-descriptors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#router-for-descriptors"}},[t._v("#")]),t._v(" Router for Descriptors")]),t._v(" "),s("p",[t._v("The function "),s("code",[t._v("routerForRoutingDescriptors")]),t._v(" allows to generate a router from RoutingDescriptors (see "),s("a",{attrs:{href:"#descriptors-maker"}},[t._v("RoutingDescriptorsMaker")]),t._v(").")]),t._v(" "),s("p",[t._v("In the code below, "),s("code",[t._v("$router")]),t._v(" is generated from "),s("code",[t._v("$routingDescriptors")]),t._v(" and bound to "),s("code",[t._v("my-group")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token package"}},[t._v("Chevere"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Components"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Router"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Routing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("routerForRoutingDescriptors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$router")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("routerForRoutingDescriptors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token argument-name"}},[t._v("descriptors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$routingDescriptors")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"using-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-router"}},[t._v("#")]),t._v(" Using Router")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Learn by Example")]),t._v(" "),s("p",[t._v("Head over to the "),s("a",{attrs:{href:"https://github.com/chevere/examples/tree/main/03.Http#01router-resolvephp",target:"_blank",rel:"noopener noreferrer"}},[t._v("Router resolve"),s("OutboundLink")],1),t._v(" example to see use-cases for the Router.")])])])}),[],!1,null,null,null);e.default=a.exports}}]);